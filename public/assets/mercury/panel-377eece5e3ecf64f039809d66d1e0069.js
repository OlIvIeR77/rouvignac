(function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var s in n)e.call(n,s)&&(t[s]=n[s]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};this.Mercury.Panel=function(e){function n(e,t,i){this.url=e,this.name=t,this.options=null!=i?i:{},n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.build=function(){var e;return this.element=jQuery("<div>",{"class":"mercury-panel loading",style:"display:none;"}),this.titleElement=jQuery("<h1><span>"+Mercury.I18n(this.options.title)+"</span></h1>").appendTo(this.element),this.paneElement=jQuery("<div>",{"class":"mercury-panel-pane"}).appendTo(this.element),this.options.closeButton&&jQuery("<a/>",{"class":"mercury-panel-close"}).appendTo(this.titleElement).css({opacity:0}),this.element.appendTo(null!=(e=jQuery(this.options.appendTo).get(0))?e:"body")},n.prototype.bindEvents=function(){return Mercury.on("resize",function(e){return function(){return e.position(e.visible)}}(this)),Mercury.on("hide:panels",function(e){return function(t,n){return n!==e?(e.button.removeClass("pressed"),e.hide()):void 0}}(this)),this.titleElement.find(".mercury-panel-close").on("click",function(e){return e.preventDefault(),Mercury.trigger("hide:panels")}),this.element.on("mousedown",function(e){return e.stopPropagation()}),this.element.on("ajax:beforeSend",function(e){return function(t,n,i){return i.success=function(t){return e.loadContent(t),e.resize()}}}(this)),n.__super__.bindEvents.apply(this,arguments)},n.prototype.show=function(){return Mercury.trigger("hide:panels",this),n.__super__.show.apply(this,arguments)},n.prototype.resize=function(){var e,t,n;return this.titleElement.find(".mercury-panel-close").css({opacity:0}),this.paneElement.css({display:"none"}),n=this.element.width(),this.paneElement.css({visibility:"hidden",width:"auto",display:"block"}),t=this.element.width(),this.paneElement.css({visibility:"visible",display:"none"}),e=this.element.offset(),this.element.animate({left:e.left-(t-n),width:t},200,"easeInOutSine",function(e){return function(){return e.titleElement.find(".mercury-panel-close").animate({opacity:1},100),e.paneElement.css({display:"block",width:t}),jQuery(e.paneElement.find(".focusable").get(0)).focus(),e.makeDraggable()}}(this)),this.visible?void 0:this.hide()},n.prototype.position=function(e){var t,n,i,s,r;return this.element.css({display:"block",visibility:"hidden"}),s=this.element.offset(),t=this.element.width(),n=Mercury.displayRect.height-16,r=n-this.titleElement.outerHeight(),this.paneElement.css({height:r,overflowY:30>r?"hidden":"auto"}),this.moved||(i=Mercury.displayRect.width-t-20),8>=i&&(i=8),(this.pinned||t+s.left>Mercury.displayRect.width-20)&&(i=Mercury.displayRect.width-t-20),this.element.css({top:Mercury.displayRect.top+8,left:i,height:n,display:e?"block":"none",visibility:"visible"}),this.makeDraggable(),e?void 0:this.element.hide()},n.prototype.loadContent=function(e){return this.loaded=!0,this.element.removeClass("loading"),this.paneElement.css({visibility:"hidden"}),this.paneElement.html(e),Mercury.config.localization.enabled?this.paneElement.localize(Mercury.locale()):void 0},n.prototype.makeDraggable=function(){var e;return e=this.element.width(),this.element.draggable({handle:"h1 span",axis:"x",opacity:.7,scroll:!1,addClasses:!1,iframeFix:!0,containment:[8,0,Mercury.displayRect.width-e-20,0],stop:function(t){return function(){var n;return n=t.element.offset().left,t.moved=!0,t.pinned=n>Mercury.displayRect.width-e-30?!0:!1,!0}}(this)})},n}(Mercury.Dialog)}).call(this);