(function(){this.Mercury.modalHandlers.insertTable={initialize:function(){return this.table=this.element.find("#table_display table"),this.table.on("click",function(t){return function(e){return t.onCellClick($(e.target))}}(this)),this.element.find("#table_alignment").on("change",function(t){return function(){return t.setTableAlignment()}}(this)),this.element.find("#table_border").on("keyup",function(t){return function(){return t.setTableBorder()}}(this)),this.element.find("#table_spacing").on("keyup",function(t){return function(){return t.setTableCellSpacing()}}(this)),this.element.find("[data-action]").on("click",function(t){return function(e){return e.preventDefault(),t.onActionClick(jQuery(e.target).data("action"))}}(this)),this.selectFirstCell(),this.element.find("form").on("submit",function(t){return function(e){return e.preventDefault(),t.submitForm(),t.hide()}}(this))},selectFirstCell:function(){var t;return t=this.table.find("td, th").first(),t.addClass("selected"),Mercury.tableEditor(this.table,t,"&nbsp;")},onCellClick:function(t){return this.cell=t,this.table=this.cell.closest("table"),this.table.find(".selected").removeAttr("class"),this.cell.addClass("selected"),Mercury.tableEditor(this.table,this.cell,"&nbsp;")},onActionClick:function(t){return t?Mercury.tableEditor[t]():void 0},setTableAlignment:function(){return this.table.attr({align:this.element.find("#table_alignment").val()})},setTableBorder:function(){var t;return t=parseInt(this.element.find("#table_border").val(),10),isNaN(t)?this.table.removeAttr("border"):this.table.attr({border:t})},setTableCellSpacing:function(){var t;return t=parseInt(this.element.find("#table_spacing").val(),10),isNaN(t)?this.table.removeAttr("cellspacing"):this.table.attr({cellspacing:t})},submitForm:function(){var t,e;return this.table.find(".selected").removeAttr("class"),this.table.find("td, th").html("<br/>"),t=jQuery("<div>").html(this.table).html(),e=t.replace(/^\s+|\n/gm,"").replace(/(<\/.*?>|<table.*?>|<tbody>|<tr>)/g,"$1\n"),Mercury.trigger("action",{action:"insertTable",value:e})}}}).call(this);